{"version":3,"sources":["../src/jaws-logger.js"],"names":[],"mappings":"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","file":"jaws-logger.js","sourcesContent":["\"use strict\";\n\n/**\n * Wraps a logging library and resolves a promise when all log messages have been written\n * \n * \n * Credentials for Papertrail:\n *     {\n            level: 'info',\n            hostname: 'hostname',\n            host: 'logs3.papertrailapp.com',\n            port: 134324\n        }\n */\nvar debug = require('debug')('Logging'),\n\tJawsLoggerPapertrail = require('./jaws-logger-papertrail.js'),\n\tJawsLoggerLoggly = require('./jaws-logger-loggly.js');\n\nclass JawsLogger {\n\tconstructor(id, loggerTransport, credentials) {\n\t\tthis.count = 0;\n\t\tthis.id_ = id + ' ' || 'Logger ';\n\t\tloggerTransport = loggerTransport || \"console\";\n\t\tthis.loggerTransport = loggerTransport;\n\t\tswitch(loggerTransport) {\n\t\t\tcase \"papertrail\":\n\t\t\t\tthis.logger = JawsLoggerPapertrail(credentials);\n\t\t\t\tbreak;\n\t\t\tcase \"loggly\":\n\t\t\t\tthis.logger = JawsLoggerLoggly(credentials);\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tvar JawsLoggerConsole = require('./jaws-logger-console.js');\n\t\t\t\tthis.logger = JawsLoggerConsole;\n\t\t}\n\n\t\tthis.logger.on('logging', () => {\n\t\t\tthis.count--;\n\t\t\tif (this.count === 0 && this.resolution) return this.resolution();\n\t\t});\n\t\tvar startupmsg = this.loggerTransport + ' logger started';\n\t\tthis.info(startupmsg);\n\t}\n\n\tid(loggerid) {\n\t\tthis.id_ = loggerid + ' ';\n\t\tthis.info('configured.');\n\t}\n\t\n\tbindResolve(resolve) {\n\t\treturn (data => {\n\t\t\tconsole.log(this.count);\n\t\t\tif (this.count == 0) return resolve(data);\n\t\t\tthis.resolution = function(){resolve(data)};\n\t\t});\n\t}\n\t\n\tbindReject(reject) {\n\t\treturn (data => {\n\t\t\tif (this.count == 0) return reject(data);\n\t\t\tthis.resolution = function(){reject(data)};\n\t\t});\n\t}\n\n\tinfo(msg) {\n\t\tvar strmsg, logmsg = msg;\n\t\tif (typeof msg === 'object') { \n\t\t\tstrmsg = this.id_ + JSON.stringify(msg);\n\t\t\tlogmsg.logid = this.id_;\n\t\t}\n\t\tif (typeof msg === 'string') {\n\t\t\tstrmsg = logmsg = this.id_ + msg;\n\t\t}\n\t\t\n        this.count++;\n\t\tif (this.loggerTransport !== \"console\") {\n\t\t\tconsole.log(strmsg);\n\t\t}\n\t\tif (this.loggerTransport == 'loggly') this.logger.info(msg);\n\t\tif (this.loggerTransport == 'papertrail') this.logger.info(strmsg);\n    }\n\t\n\terror(msg) {\n\t\tvar strmsg, logmsg = msg;\n\t\tif (typeof msg === 'object') { \n\t\t\tstrmsg = this.id_ + JSON.stringify(msg);\n\t\t\tlogmsg.logid = this.id_;\n\t\t}\n\t\tif (typeof msg === 'string') {\n\t\t\tstrmsg = logmsg = this.id_ + msg;\n\t\t}\n\t\t\n        this.count++;\n\t\tif (this.loggerTransport !== \"console\") {\n\t\t\tconsole.log(strmsg);\n\t\t}\n\t\tif (this.loggerTransport == 'loggly') this.logger.error(msg);\n\t\tif (this.loggerTransport == 'papertrail') this.logger.error(strmsg);\n    }\n}\n\nmodule.exports.CreateLogger = function (id, loggerTransport, credentials) {\n\treturn new JawsLogger(id, loggerTransport, credentials);\n};"]}